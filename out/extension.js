import*as t from"vscode";var c="subframe7536.custom-ui-style",d="custom-ui-style.external.imports",v="custom-ui-style.reload",a="tyrianNight.islandUiConsent",s;async function N(e){s=e;try{U(),await C(),await S()}catch(o){let i=o instanceof Error?o.message:String(o);t.window.showErrorMessage(`Tyrian Night: ${i}`)}}function U(){s.subscriptions.push(t.commands.registerCommand("tyrianNight.restoreClassicUi",I),t.commands.registerCommand("tyrianNight.prepareUninstall",x))}async function C(){let e=t.extensions.getExtension(c),i=l().some(n=>n.includes("tyrian-night.css"));!e&&i&&await t.window.showWarningMessage("Custom UI Style is missing but CSS imports remain. Clean up?","Clean Up","Ignore")==="Clean Up"&&await g()}async function S(){if(!t.extensions.getExtension(c))return;let o=s.globalState.get(a);if(o!==!1){if(o===void 0){let i=await t.window.showInformationMessage('Tyrian Night: Enable "Island" UI layout? (Requires Custom UI Style)',"Yes","No");i==="Yes"?(await s.globalState.update(a,!0),await w()):i==="No"&&await s.globalState.update(a,!1);return}await w()}}async function w(){let e=t.extensions.getExtension(c);if(!e)return;let o=t.Uri.joinPath(s.extensionUri,"themes","tyrian-night.css"),n=`${s.globalStorageUri.fsPath}/tyrian-night.css`,u=t.Uri.file(n);try{await t.workspace.fs.createDirectory(s.globalStorageUri)}catch{}let h=await t.workspace.fs.readFile(o);await t.workspace.fs.writeFile(u,h);let m=u.toString(),f=l(),r=f.filter(y=>!p(y));r.includes(m)||r.push(m),JSON.stringify(f)!==JSON.stringify(r)&&(await t.workspace.getConfiguration().update(d,r,t.ConfigurationTarget.Global),await e.activate(),await t.commands.executeCommand(v))}async function I(){if(!await g()){t.window.showInformationMessage("Tyrian Night: No CSS imports to remove.");return}await s.globalState.update(a,!1),t.window.showInformationMessage("Tyrian Night: Classic UI restored.")}async function x(){await g(),await s.globalState.update(a,void 0);try{let e=`${s.globalStorageUri.fsPath}/tyrian-night.css`,o=t.Uri.file(e);await t.workspace.fs.delete(o)}catch{}t.window.showInformationMessage("Tyrian Night: Ready to uninstall. Please reload VSCode before uninstalling.")}async function g(){let e=l(),o=e.filter(n=>!p(n));if(o.length===e.length)return!1;await t.workspace.getConfiguration().update(d,o,t.ConfigurationTarget.Global);let i=t.extensions.getExtension(c);return i&&(await i.activate(),await t.commands.executeCommand(v)),!0}function l(){return t.workspace.getConfiguration().get(d)??[]}function p(e){return e.includes("tyrian-night.css")}function T(){}export{N as activate,T as deactivate};
//# sourceMappingURL=extension.js.map